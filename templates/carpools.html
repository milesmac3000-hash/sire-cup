{% extends "base.html" %}

{% block title %}Carpool Management - Sire Cup{% endblock %}

{% block content %}
    <h1 class="mb-8">Carpool Management</h1>
    <p class="mb-6"><a href="{{ url_for('index') }}">Back to Dashboard</a></p>

    <h2 class="mb-6">Existing Carpool Groups</h2>
    {% if carpool_groups %}
        <div class="space-y-8 mb-10">
            {% for group in carpool_groups %}
                <div class="card">
                    <h3 class="text-green-700 mb-2">{{ group.name }}</h3>
                    <p class="text-gray-700 mb-2">{{ group.description }}</p>
                    {% if group.max_members %} <p class="text-gray-700">Max Members: <span class="font-medium">{{ group.max_members }}</span></p>{% endif %}
                    
                    <h4 class="mt-6 mb-3">Members:</h4>
                    {% if group.members %}
                        <ul class="list-disc list-inside space-y-1 text-gray-700 mb-4">
                            {% for member in group.members %}
                                <li>{{ member.player.name }} <a href="{{ url_for('leave_carpool', membership_id=member.id) }}" class="btn-danger text-xs ml-2">Leave</a></li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        <p class="text-gray-600 mb-4">No members yet.</p>
                    {% endif %}
                    
                    {% if players_not_in_carpool %}
                        <h4 class="mt-6 mb-3">Join this Carpool:</h4>
                        <ul class="flex flex-wrap gap-2">
                            {% for player in players_not_in_carpool %}
                                <li><a href="{{ url_for('join_carpool', carpool_id=group.id, player_id=player.id) }}" class="px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 transition duration-200 text-sm">{{ player.name }}</a></li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p class="text-gray-600 mb-10">No carpool groups created yet.</p>
    {% endif %}

    <p><a href="{{ url_for('create_carpool') }}" class="btn-primary">Create New Carpool Group</a></p>
{% endblock %}
